---
---
{% if jekyll.environment == "production" %}
# GitHub production URL
BASE_URL="https://jmlemetayer.github.io/abba"
{% elsif jekyll.environment == "development" %}
# Default development URL
BASE_URL="http://abba-builder:4000"
{% else %}
# Custom development URL
BASE_URL="{{ jekyll.environment }}"
{% endif %}

# On exit handler
on_exit()
{
	local status=$?

	# Print a status line
	if [ ${status} -eq 0 ]
	then
		echo "ABBA has been successfully installed"
	else
		echo >&2 "Failed to install ABBA"
	fi

	# Self remove
	rm ${0}

	exit ${status}
}

trap "on_exit" EXIT

# Exit on error
set -e

# Create the .abba directory
mkdir -p .abba

# Generate the uninstall script
cat << EOF > .abba/uninstall
#!/bin/sh
rm -rf ${PWD}/.abba
EOF

chmod +x .abba/uninstall
